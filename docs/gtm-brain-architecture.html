<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTM Brain - Data Architecture</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-primary: #0f1419;
            --bg-secondary: #1a1f2e;
            --bg-card: #232b3d;
            --border: #2d3748;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --accent-blue: #60a5fa;
            --accent-purple: #a78bfa;
            --accent-green: #4ade80;
            --accent-orange: #fb923c;
            --accent-cyan: #22d3ee;
        }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }
        
        /* Header */
        header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 16px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
        }
        
        h1 {
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: -0.02em;
        }
        
        h1 span {
            color: var(--text-secondary);
            font-weight: 400;
        }
        
        .nav-links {
            display: flex;
            gap: 8px;
        }
        
        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.8rem;
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        
        .nav-links a:hover {
            color: var(--text-primary);
            background: var(--bg-card);
            border-color: var(--border);
        }
        
        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px;
        }
        
        /* Intro Section */
        .intro {
            text-align: center;
            margin-bottom: 32px;
        }
        
        .intro h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .intro p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Diagram Container */
        .diagram-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
        }
        
        /* SVG Diagram */
        .diagram-svg {
            width: 100%;
            height: 580px;
            display: block;
        }
        
        /* Node Styles */
        .node {
            cursor: pointer;
            transition: transform 0.2s, filter 0.2s;
        }
        
        .node:hover {
            filter: brightness(1.15);
        }
        
        .node-rect {
            rx: 10;
            ry: 10;
            stroke-width: 2;
            transition: stroke-width 0.2s;
        }
        
        .node:hover .node-rect {
            stroke-width: 3;
        }
        
        .node-label {
            font-family: inherit;
            font-size: 13px;
            font-weight: 600;
            fill: var(--text-primary);
            pointer-events: none;
        }
        
        .node-sublabel {
            font-family: inherit;
            font-size: 10px;
            fill: var(--text-secondary);
            pointer-events: none;
        }
        
        /* Connection Paths */
        .connection {
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            opacity: 0.7;
            transition: opacity 0.3s, stroke-width 0.3s;
        }
        
        .connection.animated {
            stroke-dasharray: 6 4;
            animation: flowAnimation 0.8s linear infinite;
        }
        
        @keyframes flowAnimation {
            from { stroke-dashoffset: 10; }
            to { stroke-dashoffset: 0; }
        }
        
        /* Flow Labels */
        .flow-label {
            font-family: inherit;
            font-size: 9px;
            fill: var(--text-muted);
            text-anchor: middle;
        }
        
        /* Lane Labels */
        .lane-label {
            font-family: inherit;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            fill: var(--text-muted);
        }
        
        /* Row Labels */
        .row-label {
            font-family: inherit;
            font-size: 10px;
            font-weight: 500;
            fill: var(--text-muted);
            text-anchor: end;
        }
        
        /* Detail Panel */
        .detail-panel {
            position: fixed;
            top: 80px;
            right: 32px;
            width: 300px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            opacity: 0;
            transform: translateX(20px);
            transition: opacity 0.3s, transform 0.3s;
            pointer-events: none;
            z-index: 200;
        }
        
        .detail-panel.visible {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
        }
        
        .detail-panel h3 {
            font-size: 1rem;
            margin-bottom: 8px;
        }
        
        .detail-panel p {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 12px;
        }
        
        .detail-panel .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .detail-panel .tech-tag {
            font-size: 0.7rem;
            padding: 3px 8px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-secondary);
        }
        
        .detail-close {
            position: absolute;
            top: 12px;
            right: 12px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 18px;
        }
        
        .detail-close:hover {
            color: var(--text-primary);
        }
        
        /* Flow Section Cards */
        .flows-section {
            margin-top: 32px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }
        
        @media (max-width: 800px) {
            .flows-section {
                grid-template-columns: 1fr;
            }
        }
        
        .flow-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: border-color 0.2s;
        }
        
        .flow-card:hover {
            border-color: var(--text-muted);
        }
        
        .flow-card h4 {
            font-size: 0.9rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .flow-card .flow-steps {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 6px;
            margin-top: 12px;
        }
        
        .flow-step {
            font-size: 0.7rem;
            padding: 4px 8px;
            background: var(--bg-card);
            border-radius: 4px;
            color: var(--text-secondary);
        }
        
        .flow-arrow {
            color: var(--text-muted);
            font-size: 0.7rem;
        }
        
        .flow-card p {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 24px;
            color: var(--text-muted);
            font-size: 0.75rem;
        }
        
        footer a {
            color: var(--accent-blue);
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }
        
        /* Technical Note */
        .tech-note {
            background: rgba(167, 139, 250, 0.1);
            border: 1px solid rgba(167, 139, 250, 0.2);
            border-radius: 8px;
            padding: 12px 16px;
            margin-top: 24px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .tech-note strong {
            color: var(--accent-purple);
        }
    </style>
</head>
<body>
    <header>
        <div class="logo-section">
            <div class="logo-icon">G</div>
            <h1>GTM Brain <span>/ Data Architecture</span></h1>
        </div>
        <nav class="nav-links">
            <a href="/account-dashboard">Dashboard</a>
            <a href="/cheat-sheet">Commands</a>
            <a href="/sales-process">Sales Process</a>
        </nav>
    </header>
    
    <div class="container">
        <div class="intro">
            <h2>How Data Flows Through GTM Brain</h2>
            <p>Four distinct flows connect user inputs to Salesforce and back. Click any node to see details.</p>
        </div>
        
        <div class="diagram-container">
            <svg class="diagram-svg" viewBox="0 0 1100 540" preserveAspectRatio="xMidYMid meet">
                <!-- Definitions -->
                <defs>
                    <!-- Gradients -->
                    <linearGradient id="gradBlue" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#3b82f6" />
                        <stop offset="100%" style="stop-color:#1d4ed8" />
                    </linearGradient>
                    <linearGradient id="gradPurple" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#8b5cf6" />
                        <stop offset="100%" style="stop-color:#6d28d9" />
                    </linearGradient>
                    <linearGradient id="gradGreen" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#22c55e" />
                        <stop offset="100%" style="stop-color:#16a34a" />
                    </linearGradient>
                    <linearGradient id="gradOrange" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#f97316" />
                        <stop offset="100%" style="stop-color:#ea580c" />
                    </linearGradient>
                    <linearGradient id="gradCyan" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#06b6d4" />
                        <stop offset="100%" style="stop-color:#0891b2" />
                    </linearGradient>
                    
                    <!-- Arrow Markers -->
                    <marker id="arrowBlue" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L6,3 z" fill="#60a5fa"/>
                    </marker>
                    <marker id="arrowPurple" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L6,3 z" fill="#a78bfa"/>
                    </marker>
                    <marker id="arrowGreen" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L6,3 z" fill="#4ade80"/>
                    </marker>
                    <marker id="arrowOrange" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L6,3 z" fill="#fb923c"/>
                    </marker>
                    <marker id="arrowCyan" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L6,3 z" fill="#22d3ee"/>
                    </marker>
                    <marker id="arrowReturn" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
                        <path d="M0,0 L0,6 L6,3 z" fill="#94a3b8"/>
                    </marker>
                </defs>
                
                <!-- Background subtle grid -->
                <pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse">
                    <path d="M 50 0 L 0 0 0 50" fill="none" stroke="rgba(255,255,255,0.02)" stroke-width="1"/>
                </pattern>
                <rect width="100%" height="100%" fill="url(#grid)"/>
                
                <!-- Column Headers -->
                <text x="140" y="30" class="lane-label">User Inputs</text>
                <text x="480" y="30" class="lane-label">GTM Brain</text>
                <text x="920" y="30" class="lane-label">Data Systems</text>
                
                <!-- Column Dividers -->
                <line x1="320" y1="45" x2="320" y2="520" stroke="rgba(255,255,255,0.05)" stroke-width="1" stroke-dasharray="4 4"/>
                <line x1="780" y1="45" x2="780" y2="520" stroke="rgba(255,255,255,0.05)" stroke-width="1" stroke-dasharray="4 4"/>
                
                <!-- Row Labels -->
                <text x="45" y="105" class="row-label">Query</text>
                <text x="45" y="215" class="row-label">Contract</text>
                <text x="45" y="325" class="row-label">Meeting</text>
                <text x="45" y="435" class="row-label">Report</text>
                
                <!-- Horizontal Row Separators -->
                <line x1="55" y1="155" x2="1050" y2="155" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
                <line x1="55" y1="265" x2="1050" y2="265" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
                <line x1="55" y1="375" x2="1050" y2="375" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
                
                <!-- ═══════════════════════════════════════════════════════════════ -->
                <!-- ROW 1: QUERY FLOW -->
                <!-- ═══════════════════════════════════════════════════════════════ -->
                
                <!-- Slack → Intent Router -->
                <path class="connection animated" 
                      d="M 230 95 L 370 95" 
                      stroke="#60a5fa" marker-end="url(#arrowBlue)"/>
                <text x="300" y="88" class="flow-label">@mention</text>
                
                <!-- Intent Router → Query Builder -->
                <path class="connection animated" 
                      d="M 530 95 L 620 95" 
                      stroke="#a78bfa" marker-end="url(#arrowPurple)"/>
                
                <!-- Query Builder → Salesforce -->
                <path class="connection animated" 
                      d="M 760 95 L 850 95" 
                      stroke="#4ade80" marker-end="url(#arrowGreen)"/>
                <text x="805" y="88" class="flow-label">SOQL</text>
                
                <!-- Salesforce → Response (return path below) -->
                <path class="connection" 
                      d="M 850 115 L 760 115" 
                      stroke="#94a3b8" marker-end="url(#arrowReturn)"/>
                <text x="805" y="130" class="flow-label">Records</text>
                
                <!-- Response back through to Slack -->
                <path class="connection" 
                      d="M 620 115 L 530 115" 
                      stroke="#94a3b8" marker-end="url(#arrowReturn)"/>
                
                <path class="connection" 
                      d="M 370 115 L 230 115" 
                      stroke="#94a3b8" marker-end="url(#arrowReturn)"/>
                <text x="300" y="130" class="flow-label">Response</text>
                
                <!-- Slack Node -->
                <g class="node" data-node="slack" transform="translate(70, 70)">
                    <rect class="node-rect" width="160" height="70" fill="url(#gradBlue)" stroke="#60a5fa"/>
                    <text x="80" y="30" class="node-label" text-anchor="middle">Slack</text>
                    <text x="80" y="46" class="node-sublabel" text-anchor="middle">@gtm-brain mentions</text>
                    <text x="80" y="58" class="node-sublabel" text-anchor="middle">Direct messages</text>
                </g>
                
                <!-- Intent Router Node -->
                <g class="node" data-node="router" transform="translate(370, 70)">
                    <rect class="node-rect" width="160" height="70" fill="url(#gradPurple)" stroke="#a78bfa"/>
                    <text x="80" y="28" class="node-label" text-anchor="middle">Intent Router</text>
                    <text x="80" y="44" class="node-sublabel" text-anchor="middle">Pattern + Semantic + ML</text>
                    <text x="80" y="58" class="node-sublabel" text-anchor="middle">cascade classification</text>
                </g>
                
                <!-- Query Builder Node -->
                <g class="node" data-node="query" transform="translate(620, 70)">
                    <rect class="node-rect" width="140" height="70" fill="var(--bg-card)" stroke="#a78bfa"/>
                    <text x="70" y="30" class="node-label" text-anchor="middle">Query Builder</text>
                    <text x="70" y="46" class="node-sublabel" text-anchor="middle">SOQL generation</text>
                    <text x="70" y="58" class="node-sublabel" text-anchor="middle">+ response format</text>
                </g>
                
                <!-- ═══════════════════════════════════════════════════════════════ -->
                <!-- ROW 2: CONTRACT FLOW -->
                <!-- ═══════════════════════════════════════════════════════════════ -->
                
                <!-- PDF → Contract Processor -->
                <path class="connection animated" 
                      d="M 230 205 L 410 205" 
                      stroke="#fb923c" marker-end="url(#arrowOrange)"/>
                <text x="320" y="198" class="flow-label">PDF text</text>
                
                <!-- Contract Processor → Salesforce -->
                <path class="connection animated" 
                      d="M 610 205 L 850 205" 
                      stroke="#4ade80" marker-end="url(#arrowGreen)"/>
                <text x="730" y="198" class="flow-label">Contract record</text>
                
                <!-- PDF Upload Node -->
                <g class="node" data-node="pdf" transform="translate(70, 180)">
                    <rect class="node-rect" width="160" height="50" fill="var(--bg-card)" stroke="#fb923c"/>
                    <text x="80" y="22" class="node-label" text-anchor="middle">Contract PDF</text>
                    <text x="80" y="38" class="node-sublabel" text-anchor="middle">Upload via Slack</text>
                </g>
                
                <!-- Contract Processor Node -->
                <g class="node" data-node="contract" transform="translate(410, 175)">
                    <rect class="node-rect" width="200" height="60" fill="var(--bg-card)" stroke="#fb923c"/>
                    <text x="100" y="25" class="node-label" text-anchor="middle">Contract Processor</text>
                    <text x="100" y="42" class="node-sublabel" text-anchor="middle">LLM extraction (GPT-4)</text>
                    <text x="100" y="54" class="node-sublabel" text-anchor="middle">Terms, dates, parties</text>
                </g>
                
                <!-- ═══════════════════════════════════════════════════════════════ -->
                <!-- ROW 3: MEETING FLOW -->
                <!-- ═══════════════════════════════════════════════════════════════ -->
                
                <!-- Hyprnote → Meeting Sync -->
                <path class="connection animated" 
                      d="M 230 315 L 410 315" 
                      stroke="#22d3ee" marker-end="url(#arrowCyan)"/>
                <text x="320" y="308" class="flow-label">Transcription</text>
                
                <!-- Meeting Sync → Salesforce -->
                <path class="connection animated" 
                      d="M 610 315 L 850 315" 
                      stroke="#4ade80" marker-end="url(#arrowGreen)"/>
                <text x="730" y="308" class="flow-label">Contact + Event</text>
                
                <!-- Hyprnote Node -->
                <g class="node" data-node="hyprnote" transform="translate(70, 290)">
                    <rect class="node-rect" width="160" height="50" fill="var(--bg-card)" stroke="#22d3ee"/>
                    <text x="80" y="22" class="node-label" text-anchor="middle">Hyprnote</text>
                    <text x="80" y="38" class="node-sublabel" text-anchor="middle">Meeting transcripts</text>
                </g>
                
                <!-- Meeting Sync Node -->
                <g class="node" data-node="meeting" transform="translate(410, 285)">
                    <rect class="node-rect" width="200" height="60" fill="var(--bg-card)" stroke="#22d3ee"/>
                    <text x="100" y="25" class="node-label" text-anchor="middle">Meeting Sync</text>
                    <text x="100" y="42" class="node-sublabel" text-anchor="middle">Name matching</text>
                    <text x="100" y="54" class="node-sublabel" text-anchor="middle">Account lookup</text>
                </g>
                
                <!-- ═══════════════════════════════════════════════════════════════ -->
                <!-- ROW 4: REPORT FLOW -->
                <!-- ═══════════════════════════════════════════════════════════════ -->
                
                <!-- Report Generator → Slack/Email (leftward) -->
                <path class="connection animated" 
                      d="M 410 425 L 230 425" 
                      stroke="#fb923c" marker-end="url(#arrowOrange)"/>
                <text x="320" y="418" class="flow-label">PDF / Excel</text>
                
                <!-- Salesforce → Report Generator -->
                <path class="connection" 
                      d="M 850 425 L 610 425" 
                      stroke="#4ade80" marker-end="url(#arrowGreen)"/>
                <text x="730" y="418" class="flow-label">Pipeline data</text>
                
                <!-- Campfire → Report Generator -->
                <path class="connection" 
                      d="M 850 475 C 750 475, 700 445, 610 445" 
                      stroke="#4ade80" stroke-dasharray="4 2" opacity="0.5"/>
                <text x="730" y="468" class="flow-label">ARR data</text>
                
                <!-- Slack/Email Output Node -->
                <g class="node" data-node="output" transform="translate(70, 400)">
                    <rect class="node-rect" width="160" height="50" fill="var(--bg-card)" stroke="#fb923c"/>
                    <text x="80" y="22" class="node-label" text-anchor="middle">Slack / Email</text>
                    <text x="80" y="38" class="node-sublabel" text-anchor="middle">Report delivery</text>
                </g>
                
                <!-- Report Generator Node -->
                <g class="node" data-node="reports" transform="translate(410, 395)">
                    <rect class="node-rect" width="200" height="60" fill="var(--bg-card)" stroke="#fb923c"/>
                    <text x="100" y="25" class="node-label" text-anchor="middle">Report Generator</text>
                    <text x="100" y="42" class="node-sublabel" text-anchor="middle">Weekly snapshots</text>
                    <text x="100" y="54" class="node-sublabel" text-anchor="middle">Pipeline exports</text>
                </g>
                
                <!-- ═══════════════════════════════════════════════════════════════ -->
                <!-- DATA SYSTEMS (Right side) -->
                <!-- ═══════════════════════════════════════════════════════════════ -->
                
                <!-- Salesforce (tall vertical bar) -->
                <g class="node" data-node="salesforce" transform="translate(850, 60)">
                    <rect class="node-rect" width="180" height="290" fill="url(#gradGreen)" stroke="#4ade80"/>
                    <text x="90" y="30" class="node-label" text-anchor="middle">Salesforce</text>
                    <text x="90" y="48" class="node-sublabel" text-anchor="middle">Source of Truth</text>
                    <line x1="20" y1="60" x2="160" y2="60" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
                    <text x="90" y="85" class="node-sublabel" text-anchor="middle">Accounts</text>
                    <text x="90" y="105" class="node-sublabel" text-anchor="middle">Opportunities</text>
                    <text x="90" y="125" class="node-sublabel" text-anchor="middle">Contracts</text>
                    <text x="90" y="145" class="node-sublabel" text-anchor="middle">Contacts</text>
                    <text x="90" y="165" class="node-sublabel" text-anchor="middle">Events</text>
                    <line x1="20" y1="185" x2="160" y2="185" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
                    <text x="90" y="210" class="node-sublabel" text-anchor="middle" style="font-style: italic">jsforce + OAuth</text>
                    <text x="90" y="228" class="node-sublabel" text-anchor="middle" style="font-style: italic">Circuit breaker</text>
                    <text x="90" y="246" class="node-sublabel" text-anchor="middle" style="font-style: italic">Rate limiting</text>
                    <text x="90" y="275" class="node-sublabel" text-anchor="middle" style="font-size: 9px; fill: #64748b">REST API</text>
                </g>
                
                <!-- Campfire ERP -->
                <g class="node" data-node="campfire" transform="translate(850, 395)">
                    <rect class="node-rect" width="180" height="60" fill="var(--bg-card)" stroke="#4ade80"/>
                    <text x="90" y="26" class="node-label" text-anchor="middle">Campfire ERP</text>
                    <text x="90" y="44" class="node-sublabel" text-anchor="middle">ARR + Finance data</text>
                </g>
                
                <!-- ═══════════════════════════════════════════════════════════════ -->
                <!-- LLM UTILITY (bottom center, dashed connections) -->
                <!-- ═══════════════════════════════════════════════════════════════ -->
                
                <!-- LLM box -->
                <g class="node" data-node="llm" transform="translate(460, 485)">
                    <rect class="node-rect" width="180" height="45" rx="22" fill="rgba(167, 139, 250, 0.15)" stroke="#a78bfa" stroke-dasharray="4 2"/>
                    <text x="90" y="20" class="node-label" text-anchor="middle" style="font-size: 11px;">LLM Services</text>
                    <text x="90" y="35" class="node-sublabel" text-anchor="middle">GPT-4 / Claude</text>
                </g>
                
                <!-- Dashed lines from LLM to components that use it -->
                <path d="M 460 507 C 400 507, 350 200, 410 205" 
                      stroke="#a78bfa" stroke-width="1" stroke-dasharray="3 3" fill="none" opacity="0.4"/>
                <path d="M 550 485 C 550 400, 510 200, 450 140" 
                      stroke="#a78bfa" stroke-width="1" stroke-dasharray="3 3" fill="none" opacity="0.4"/>
            </svg>
        </div>
        
        <!-- Technical Note -->
        <div class="tech-note">
            <strong>Architecture note:</strong> GTM Brain uses intent-based routing with specialized handlers. 
            LLM (GPT-4/Claude) enhances query understanding and data extraction, but all execution is deterministic. 
            This ensures reliable, predictable behavior for production sales operations.
        </div>
        
        <!-- Flow Cards Section -->
        <section class="flows-section">
            <div class="flow-card">
                <h4><span style="color: var(--accent-blue);">1.</span> Query Flow</h4>
                <p>Natural language Salesforce queries. The Intent Router classifies using pattern matching, semantic similarity, and ML, then routes to Query Builder for SOQL generation.</p>
                <div class="flow-steps">
                    <span class="flow-step">@gtm-brain query</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Intent Router</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Query Builder</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Salesforce</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Response</span>
                </div>
            </div>
            
            <div class="flow-card">
                <h4><span style="color: var(--accent-orange);">2.</span> Contract Processing</h4>
                <p>Upload a PDF contract to Slack. GPT-4 extracts terms, dates, and parties. Review in thread, then create a Salesforce Contract record with one click.</p>
                <div class="flow-steps">
                    <span class="flow-step">PDF Upload</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">LLM Extraction</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Review</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Create Record</span>
                </div>
            </div>
            
            <div class="flow-card">
                <h4><span style="color: var(--accent-cyan);">3.</span> Meeting Sync</h4>
                <p>Hyprnote transcriptions sync to Salesforce. Creates Contact records for new attendees, Event records for meetings, and updates Account Customer Brain field.</p>
                <div class="flow-steps">
                    <span class="flow-step">Hyprnote</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Name Matching</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Account Lookup</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Salesforce</span>
                </div>
            </div>
            
            <div class="flow-card">
                <h4><span style="color: var(--accent-purple);">4.</span> Reporting</h4>
                <p>Scheduled and on-demand reports. Weekly RevOps PDF, pipeline Excel exports, BL summaries. Pulls from Salesforce (and optionally Campfire for ARR).</p>
                <div class="flow-steps">
                    <span class="flow-step">Schedule / Request</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Query Data</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Generate Report</span>
                    <span class="flow-arrow">→</span>
                    <span class="flow-step">Deliver</span>
                </div>
            </div>
        </section>
    </div>
    
    <!-- Detail Panel -->
    <div class="detail-panel" id="detailPanel">
        <button class="detail-close" onclick="closeDetail()">&times;</button>
        <h3 id="detailTitle"></h3>
        <p id="detailDesc"></p>
        <div class="tech-stack" id="detailTech"></div>
    </div>
    
    <footer>
        GTM Brain Data Architecture &bull; Eudia RevOps &bull; <a href="/cheat-sheet">View Commands</a>
    </footer>
    
    <script>
        const nodeDetails = {
            slack: {
                title: 'Slack Interface',
                desc: 'Primary user interface via @slack/bolt in socket mode. Users mention @gtm-brain in channels or send direct messages. Also handles file uploads for contract processing.',
                tech: ['@slack/bolt', 'Socket Mode', 'Block Kit', 'File API']
            },
            router: {
                title: 'Intent Router',
                desc: 'Classifies user queries using a cascade approach: (1) Exact match from learned queries, (2) Semantic similarity via embeddings, (3) Pattern matching with regex, (4) LLM classification as fallback. Routes to appropriate handler based on intent.',
                tech: ['mlIntentClassifier.js', 'semanticMatcher.js', 'intentParser.js', 'OpenAI Embeddings']
            },
            query: {
                title: 'Query Builder',
                desc: 'Translates parsed intent into valid SOQL queries. Uses schema definitions for field validation. Formats Salesforce results into Slack Block Kit messages with pagination.',
                tech: ['queries.js', 'SOQL', 'responseFormatter.js', 'Block Kit']
            },
            salesforce: {
                title: 'Salesforce',
                desc: 'Source of truth for all pipeline data. Connected via jsforce with OAuth. Circuit breaker prevents auth rate limit issues. Stores Accounts, Opportunities, Contracts, Contacts, and Events.',
                tech: ['jsforce', 'OAuth 2.0', 'REST API', 'Circuit Breaker']
            },
            pdf: {
                title: 'Contract PDF Upload',
                desc: 'Drag-and-drop PDF contracts into Slack. File handler detects PDF uploads, extracts text, and passes to Contract Processor for analysis.',
                tech: ['Slack Files API', 'MIME Detection', 'Text Extraction']
            },
            contract: {
                title: 'Contract Processor',
                desc: 'Uses GPT-4 to extract structured data from contract text: customer name, financial terms, dates, signers, product lines. Results shown in Slack thread for review before creating Salesforce record.',
                tech: ['llmContractExtractor.js', 'GPT-4', 'contractCreation.js']
            },
            hyprnote: {
                title: 'Hyprnote',
                desc: 'External meeting transcription tool used by the team. Captures conversation summaries, action items, and attendee information. Syncs to GTM Brain via command.',
                tech: ['External Tool', 'Transcription', 'sync hyprnote command']
            },
            meeting: {
                title: 'Meeting Sync',
                desc: 'Processes Hyprnote transcriptions. Matches attendee names to Salesforce Contacts using fuzzy matching. Creates new Contact records for unknown attendees. Links Events to Accounts and updates Customer Brain field.',
                tech: ['hyprnoteSyncService.js', 'fuzzyAccountMatcher.js', 'Contact API']
            },
            output: {
                title: 'Report Delivery',
                desc: 'Delivers generated reports via Slack messages or email. Weekly RevOps summary sent to leadership. BL summaries posted to #gtm-account-planning channel.',
                tech: ['Slack API', 'Microsoft Graph', 'Email delivery']
            },
            reports: {
                title: 'Report Generator',
                desc: 'Generates scheduled and on-demand reports. Weekly RevOps PDF with pipeline snapshots, signed revenue, and metrics. Pipeline Excel exports with full deal details. Uses PDFKit and ExcelJS.',
                tech: ['blWeeklySummary.js', 'weeklyReport.js', 'PDFKit', 'ExcelJS']
            },
            campfire: {
                title: 'Campfire ERP',
                desc: 'Finance-owned ERP system for contract and ARR management. Provides authoritative revenue data for reconciliation. Used optionally in reporting for ARR validation.',
                tech: ['REST API', 'Finance Integration', 'ARR Tracking']
            },
            llm: {
                title: 'LLM Services',
                desc: 'GPT-4 and Claude (via Socrates gateway) power intelligent features. Used for contract extraction, semantic query matching, and classification fallback. Enhances understanding, but execution remains deterministic.',
                tech: ['GPT-4', 'Claude Sonnet', 'Socrates Gateway', 'OpenAI Embeddings']
            }
        };
        
        document.querySelectorAll('.node').forEach(node => {
            node.addEventListener('click', (e) => {
                const nodeId = node.dataset.node;
                const detail = nodeDetails[nodeId];
                if (detail) {
                    showDetail(detail);
                }
            });
        });
        
        function showDetail(detail) {
            const panel = document.getElementById('detailPanel');
            document.getElementById('detailTitle').textContent = detail.title;
            document.getElementById('detailDesc').textContent = detail.desc;
            document.getElementById('detailTech').innerHTML = detail.tech
                .map(t => `<span class="tech-tag">${t}</span>`)
                .join('');
            panel.classList.add('visible');
        }
        
        function closeDetail() {
            document.getElementById('detailPanel').classList.remove('visible');
        }
        
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.node') && !e.target.closest('.detail-panel')) {
                closeDetail();
            }
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeDetail();
            }
        });
    </script>
</body>
</html>
